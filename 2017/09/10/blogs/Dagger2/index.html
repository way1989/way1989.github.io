<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 7.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"way1989.github.io","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="Dagger2å…¥é—¨ä»¥åŠæ·±å…¥ç†è§£">
<meta property="og:type" content="article">
<meta property="og:title" content="è§£è€¦ç¥å™¨Dagger2">
<meta property="og:url" content="https://way1989.github.io/2017/09/10/blogs/Dagger2/index.html">
<meta property="og:site_name" content="liweiping">
<meta property="og:description" content="Dagger2å…¥é—¨ä»¥åŠæ·±å…¥ç†è§£">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/way1989/way1989.github.io/hexo/images_post/dagger2/1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/way1989/way1989.github.io/hexo/images_post/dagger2/2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/way1989/way1989.github.io/hexo/images_post/dagger2/3.png">
<meta property="article:published_time" content="2017-09-10T03:16:24.000Z">
<meta property="article:modified_time" content="2025-02-23T13:38:11.290Z">
<meta property="article:author" content="liweiping">
<meta property="article:tag" content="Dagger2">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/way1989/way1989.github.io/hexo/images_post/dagger2/1.png">

<link rel="canonical" href="https://way1989.github.io/2017/09/10/blogs/Dagger2/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>è§£è€¦ç¥å™¨Dagger2 | liweiping</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">liweiping</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://way1989.github.io/2017/09/10/blogs/Dagger2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="liweiping">
      <meta itemprop="description" content="çˆ±ç”Ÿæ´»...çˆ±Android...">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="liweiping">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          è§£è€¦ç¥å™¨Dagger2
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2017-09-10 11:16:24" itemprop="dateCreated datePublished" datetime="2017-09-10T11:16:24+08:00">2017-09-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2025-02-23 21:38:11" itemprop="dateModified" datetime="2025-02-23T21:38:11+08:00">2025-02-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Dagger2/" itemprop="url" rel="index"><span itemprop="name">Dagger2</span></a>
                </span>
            </span>

          
            <div class="post-description">Dagger2å…¥é—¨ä»¥åŠæ·±å…¥ç†è§£</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h2 id="ä¸€-Dagger2ä»‹ç»"><a href="#ä¸€-Dagger2ä»‹ç»" class="headerlink" title="ä¸€. Dagger2ä»‹ç»"></a>ä¸€. Dagger2ä»‹ç»</h2><h3 id="1-Dagger2æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-Dagger2æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.Dagger2æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.Dagger2æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>&emsp;&emsp;Dagger2æ˜¯ç”±Googleæ¥æ‰‹å¼€å‘ï¼Œæœ€æ—©çš„ç‰ˆæœ¬Dagger1 æ˜¯ç”±Squareå…¬å¸å¼€å‘çš„ï¼Œå¤§ç¥<a href="https://github.com/JakeWharton">JakeWharton</a>æœ€è¿‘ä¹Ÿä» Square å…¬å¸è·³æ§½åˆ° Googleã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">A fast dependency injector <span class="keyword">for</span> Android and Java</span><br><span class="line">Androidå’ŒJavaçš„ä¾èµ–å¿«é€Ÿæ³¨å…¥å™¨</span><br></pre></td></tr></table></figure>

<h3 id="2-Dagger2ç›¸è¾ƒäºDagger1çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#2-Dagger2ç›¸è¾ƒäºDagger1çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="2. Dagger2ç›¸è¾ƒäºDagger1çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ"></a>2. Dagger2ç›¸è¾ƒäºDagger1çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ</h3><ul>
<li><strong>æ›´å¥½çš„æ€§èƒ½</strong>ï¼šç›¸è¾ƒäºDagger1ï¼Œå®ƒä½¿ç”¨çš„é¢„ç¼–è¯‘æœŸé—´ç”Ÿæˆä»£ç æ¥å®Œæˆä¾èµ–æ³¨å…¥ï¼Œè€Œä¸æ˜¯ç”¨çš„åå°„ã€‚å¤§å®¶çŸ¥é“åå°„å¯¹æ‰‹æœºåº”ç”¨å¼€å‘å½±å“æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œå› ä¸ºåå°„æ˜¯åœ¨ç¨‹åºè¿è¡Œæ—¶åŠ è½½ç±»æ¥è¿›è¡Œå¤„ç†æ‰€ä»¥ä¼šæ¯”è¾ƒè€—æ—¶ï¼Œè€Œæ‰‹æœºç¡¬ä»¶èµ„æºæœ‰é™ï¼Œæ‰€ä»¥ç›¸å¯¹æ¥è¯´ä¼šå¯¹æ€§èƒ½äº§ç”Ÿä¸€å®šçš„å½±å“ã€‚</li>
<li><strong>å®¹æ˜“è·Ÿè¸ªè°ƒè¯•</strong>ï¼šå› ä¸ºDagger2æ˜¯ä½¿ç”¨ç”Ÿæˆä»£ç æ¥å®ç°å®Œæ•´ä¾èµ–æ³¨å…¥ï¼Œæ‰€ä»¥å®Œå…¨å¯ä»¥åœ¨ç›¸å…³ä»£ç å¤„ä¸‹æ–­ç‚¹è¿›è¡Œè¿è¡Œè°ƒè¯•ã€‚</li>
</ul>
<h3 id="3-ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#3-ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="3. ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ"></a>3. ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ</h3><p>&emsp;&emsp;å¿«é€Ÿè‡ªåŠ¨çš„æ„å»ºå‡ºæˆ‘ä»¬æ‰€éœ€è¦çš„ä¾èµ–å¯¹è±¡ï¼Œè¿™é‡Œçš„ä¾èµ–å¯¹è±¡å¯ä»¥ç†è§£ä¸ºæŸä¸€ä¸ªæˆå‘˜å˜é‡ã€‚ä¾‹å¦‚åœ¨ <code>MVP</code> ä¸­ï¼Œ<code>VP</code> å±‚å°±æ˜¯äº’ç›¸å…³è”çš„ï¼Œ <code>V</code> è¦ä¾èµ–å¯¹åº”çš„ <code>P</code>ï¼Œè€Œ <code>P</code> ä¹Ÿè¦ä¾èµ–å¯¹åº”çš„ <code>V</code> ã€‚Dagger2 èƒ½è§£å†³çš„å°±æ˜¯è¿™ç§ä¾èµ–å…³ç³»ï¼Œé€šè¿‡æ³¨å…¥çš„æ–¹å¼ï¼Œå°†åŒæ–¹çš„è€¦åˆå†æ¬¡é™ä½ï¼Œåœ¨å®é™…çš„ä½¿ç”¨ä¸­ä½“ç°ä¸ºä¸€ä¸ªæ³¨è§£æƒ³è¦çš„å¯¹è±¡å°±åˆ›å»ºå¥½äº†ï¼Œå’±ä»¬ä¸ç”¨å†å»ç®¡ç†æ‰€ä¾èµ–å¯¹è±¡çš„åˆ›å»ºç­‰æƒ…å†µäº†ã€‚</p>
<h3 id="4-ä¸¾ä¸ªä¾‹å­"><a href="#4-ä¸¾ä¸ªä¾‹å­" class="headerlink" title="4. ä¸¾ä¸ªä¾‹å­"></a>4. ä¸¾ä¸ªä¾‹å­</h3><p>&emsp;&emsp;å¦‚æœåœ¨ <code>MainActivity</code> ä¸­ï¼Œæœ‰ <code>Tinno</code>çš„å®ä¾‹ï¼Œåˆ™ç§° <code>MainActivity</code> å¯¹ <code>Tinno</code> æœ‰ä¸€ä¸ªä¾èµ–ã€‚å¦‚æœä¸ç”¨Dagger2çš„æƒ…å†µä¸‹æˆ‘ä»¬åº”è¯¥è¿™ä¹ˆå†™ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Tinno mTinno;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">MainActivity</span><span class="params">()</span> &#123;</span><br><span class="line">    mTinno = <span class="keyword">new</span> <span class="title class_">Tinno</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ä¸Šé¢ä¾‹å­é¢ä¸´ç€ä¸€ä¸ªé—®é¢˜ï¼Œä¸€æ—¦æŸä¸€å¤©<code>Tinno</code>çš„åˆ›å»ºæ–¹å¼ï¼ˆå¦‚æ„é€ å‚æ•°ï¼‰å‘ç”Ÿæ”¹å˜ï¼Œé‚£ä¹ˆä½ ä¸ä½†éœ€è¦ä¿®æ”¹<code>MainActivity</code>ä¸­åˆ›å»º<code>Tinno</code>çš„ä»£ç ï¼Œè¿˜è¦ä¿®æ”¹å…¶ä»–æ‰€æœ‰åœ°æ–¹åˆ›å»º<code>Tinno</code>çš„ä»£ç ã€‚å¦‚æœæˆ‘ä»¬ä½¿ç”¨äº†Dagger2çš„è¯ï¼Œå°±ä¸éœ€è¦ç®¡è¿™äº›äº†ï¼Œåªéœ€è¦åœ¨éœ€è¦<code>Tinno</code>çš„åœ°æ–¹å†™ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Inject</span></span><br><span class="line">Tinno mTinno;</span><br></pre></td></tr></table></figure>

<h2 id="äºŒ-Dagger2ä½¿ç”¨"><a href="#äºŒ-Dagger2ä½¿ç”¨" class="headerlink" title="äºŒ. Dagger2ä½¿ç”¨"></a>äºŒ. Dagger2ä½¿ç”¨</h2><h3 id="1-gradleé…ç½®"><a href="#1-gradleé…ç½®" class="headerlink" title="1. gradleé…ç½®"></a>1. gradleé…ç½®</h3><p>&emsp;&emsp;Android Studio 2.2ä»¥å‰çš„ç‰ˆæœ¬éœ€è¦ä½¿ç”¨Gradleæ’ä»¶<code>android-apt</code>(Annotation Processing Tool)ï¼ŒååŠ©Android Studioå¤„ç†<code>annotation processors</code>ï¼›<code>annotationProcessor</code>å°±æ˜¯APTå·¥å…·ä¸­çš„ä¸€ç§ï¼Œæ˜¯googleå¼€å‘çš„å†…ç½®æ¡†æ¶ï¼Œä¸éœ€è¦å¼•å…¥ï¼Œæ‰€ä»¥å¯ä»¥åƒä¸‹é¢è¿™æ ·ç›´æ¥ä½¿ç”¨ã€‚</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Add Dagger dependencies</span></span><br><span class="line">dependencies &#123;</span><br><span class="line">  compile <span class="string">&#x27;com.google.dagger:dagger:2.4&#x27;</span></span><br><span class="line">  annotationProcessor <span class="string">&#x27;com.google.dagger:dagger-compiler:2.4&#x27;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="2-æ³¨è§£"><a href="#2-æ³¨è§£" class="headerlink" title="2. æ³¨è§£"></a>2. æ³¨è§£</h3><p>&emsp;&emsp;Dagger2 é€šè¿‡æ³¨è§£æ¥ç”Ÿæˆä»£ç ï¼Œå®šä¹‰ä¸åŒçš„è§’è‰²ï¼Œä¸»è¦çš„æ³¨è§£å¦‚ä¸‹ï¼š</p>
<ul>
<li><strong>@Module</strong>: ç”¨æ¥æ ‡æ³¨ç±»ï¼Œ<code>Module</code>ç±»é‡Œé¢çš„æ–¹æ³•ä¸“é—¨æä¾›ä¾èµ–ï¼Œæ‰€ä»¥æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªç±»ï¼Œç”¨<code>@Module</code>æ³¨è§£ï¼Œè¿™æ ·Daggeråœ¨æ„é€ ç±»çš„å®ä¾‹çš„æ—¶å€™ï¼Œå°±çŸ¥é“ä»å“ªé‡Œå»æ‰¾åˆ°éœ€è¦çš„ä¾èµ–ã€‚</li>
<li><strong>@Provides</strong>: ç”¨æ¥æ ‡æ³¨æ–¹æ³•ï¼Œåœ¨<code>Module</code>ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰çš„æ–¹æ³•æ˜¯ç”¨è¿™ä¸ªæ³¨è§£ï¼Œä»¥æ­¤æ¥å‘Šè¯‰<code>Dagger2</code>æˆ‘ä»¬æƒ³è¦æ„é€ å¯¹è±¡å¹¶æä¾›è¿™äº›ä¾èµ–ã€‚</li>
<li><strong>@Inject</strong>: ç”¨æ¥æ ‡æ³¨å¯¹è±¡å˜é‡æˆ–æ„é€ æ–¹æ³•ï¼Œé€šå¸¸åœ¨éœ€è¦ä¾èµ–çš„åœ°æ–¹ä½¿ç”¨è¿™ä¸ªæ³¨è§£ã€‚æ¢å¥è¯è¯´ï¼Œä½ ç”¨å®ƒå‘Šè¯‰<code>Dagger2</code>è¿™ä¸ªç±»æˆ–è€…å­—æ®µéœ€è¦ä¾èµ–æ³¨å…¥ã€‚è¿™æ ·ï¼Œ<code>Dagger2</code>å°±ä¼šæ„é€ ä¸€ä¸ªè¿™ä¸ªç±»çš„å®ä¾‹å¹¶æ»¡è¶³ä»–ä»¬çš„ä¾èµ–ã€‚</li>
<li><strong>@Component</strong>: é€šå¸¸ç”¨æ¥æ ‡æ³¨æ¥å£ï¼Œ<code>Component</code>ä»æ ¹æœ¬ä¸Šæ¥è¯´å°±æ˜¯ä¸€ä¸ªæ³¨å…¥å™¨ï¼Œä¹Ÿå¯ä»¥è¯´æ˜¯<code>@Inject</code>å’Œ<code>@Module</code>çš„æ¡¥æ¢ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨å°±æ˜¯è¿æ¥è¿™ä¸¤ä¸ªéƒ¨åˆ†ã€‚å°†<code>Module</code>ä¸­äº§ç”Ÿçš„ä¾èµ–å¯¹è±¡è‡ªåŠ¨æ³¨å…¥åˆ°éœ€è¦ä¾èµ–å®ä¾‹çš„Containerä¸­ã€‚</li>
<li><strong>@Scope</strong>: æ ‡æ³¨<code>Component</code>å’Œ<code>Module</code>æä¾›å¯¹è±¡çš„æ–¹æ³•ï¼Œ<code>Dagger2</code>å¯ä»¥é€šè¿‡è‡ªå®šä¹‰æ³¨è§£é™å®šæ³¨è§£ä½œç”¨åŸŸï¼Œæ¥ç®¡ç†æ¯ä¸ªå¯¹è±¡å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸã€‚</li>
<li><strong>@Qualifier</strong>: ç”¨æ¥æ ‡æ³¨æ–¹æ³•ï¼Œå½“ç±»çš„ç±»å‹ä¸è¶³ä»¥é‰´åˆ«ä¸€ä¸ªä¾èµ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ³¨è§£æ ‡ç¤ºã€‚ä¾‹å¦‚ï¼šåœ¨Androidä¸­ï¼Œæˆ‘ä»¬ä¼šéœ€è¦ä¸åŒç±»å‹çš„<code>Context</code>ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥å®šä¹‰<code>Qualifier</code>æ³¨è§£<code>@ApplicationQualifier</code>å’Œ<code>@ActivityQualifier</code>ï¼Œè¿™æ ·å½“æ³¨å…¥ä¸€ä¸ª<code>Context</code>çš„æ—¶å€™ï¼Œæˆ‘ä»¬å°±å¯ä»¥å‘Šè¯‰<code>Dagger2</code>æˆ‘ä»¬æƒ³è¦å“ªç§ç±»å‹çš„<code>Context</code>ã€‚</li>
</ul>
<h3 id="3-ç»“æ„"><a href="#3-ç»“æ„" class="headerlink" title="3. ç»“æ„"></a>3. ç»“æ„</h3><p>&emsp;&emsp;Dagger2è¦å®ç°ä¸€ä¸ªå®Œæ•´çš„ä¾èµ–æ³¨å…¥ï¼Œé€šå¸¸å¿…ä¸å¯å°‘çš„å…ƒç´ æœ‰ä¸‰ç§ï¼š<strong>Module</strong>ï¼Œ<strong>Component</strong>ï¼Œ<strong>Container</strong>ã€‚ä¸ºäº†ä¾¿äºç†è§£ï¼Œå…¶å®å¯ä»¥æŠŠ<code>component</code>æƒ³è±¡æˆ<code>é’ˆç®¡</code>ï¼Œ<code>module</code>æ˜¯<code>æ³¨å°„å™¨</code>ï¼Œé‡Œé¢çš„<code>ä¾èµ–å¯¹è±¡</code>æ˜¯<code>å¾…æ³¨å…¥çš„è¯æ°´</code>ï¼Œ<code>buildæ–¹æ³•</code>æ˜¯æ’è¿›<code>æ‚£è€…ï¼ˆContainerï¼‰</code>ï¼Œ<code>injectæ–¹æ³•</code>çš„è°ƒç”¨æ˜¯<code>æ¨åŠ¨æ´»å¡</code>ã€‚</p>
<div align="center"><img src="https://raw.githubusercontent.com/way1989/way1989.github.io/hexo/images_post/dagger2/1.png"/></div>

<h3 id="4-ç®€å•çš„ä¾‹å­"><a href="#4-ç®€å•çš„ä¾‹å­" class="headerlink" title="4. ç®€å•çš„ä¾‹å­"></a>4. ç®€å•çš„ä¾‹å­</h3><p><strong>å£°æ˜éœ€è¦ä¾èµ–çš„å¯¹è±¡</strong>ï¼šä½¿ç”¨äº†æ³¨è§£æ–¹å¼ï¼Œè¿˜æ˜¯ä»¥<code>Tinno</code>ä¸ºä¾‹ï¼Œä½¿å¾—Dagger2èƒ½æ‰¾åˆ°å®ƒã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tinno</span> &#123;</span><br><span class="line">    <span class="meta">@Inject</span> <span class="comment">//è¿™é‡Œå¯ä»¥çœ‹åˆ°åŠ å…¥äº†æ³¨è§£æ–¹å¼</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Tinno</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <strong>å£°æ˜<code>Component</code>æ¥å£</strong>ï¼šå£°æ˜å®Œårebuildä¸€ä¸‹å·¥ç¨‹ï¼Œä½¿å…¶è‡ªåŠ¨ç”Ÿæˆ<code>Component</code>å®ç°ç±»<code>DaggerMainActivityComponent</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ç”¨è¿™ä¸ªæ ‡æ³¨æ ‡è¯†æ˜¯ä¸€ä¸ªè¿æ¥å™¨</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MainActivityComponent</span> &#123;</span><br><span class="line">    <span class="comment">//è¿™ä¸ªè¿æ¥å™¨è¦æ³¨å…¥çš„å¯¹è±¡ã€‚è¿™ä¸ªinjectæ ‡æ³¨çš„æ„æ€æ˜¯ï¼Œæˆ‘åé¢çš„å‚æ•°å¯¹è±¡é‡Œé¢æœ‰æ ‡æ³¨ä¸º@Injectçš„å±æ€§ï¼Œè¿™ä¸ªæ ‡æ³¨çš„å±æ€§æ˜¯éœ€è¦è¿™ä¸ªè¿æ¥å™¨æ³¨å…¥è¿›æ¥çš„ã€‚</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">inject</span><span class="params">(MainActivity activity)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <strong>åœ¨ä½¿ç”¨çš„åœ°æ–¹æ³¨å…¥ï¼Œè¿™é‡Œæ˜¯ MainActivityï¼š</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TAG</span> <span class="operator">=</span> <span class="string">&quot;MainActivity&quot;</span>;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Tinno mTinno;<span class="comment">//åŠ å…¥æ³¨è§£ï¼Œæ ‡æ³¨è¿™ä¸ªTinnoæ˜¯éœ€è¦æ³¨å…¥çš„</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        <span class="type">TextView</span> <span class="variable">dagger2TextView</span> <span class="operator">=</span> (TextView) findViewById(R.id.dagger2_text_view);</span><br><span class="line">        <span class="comment">//ä½¿ç”¨ç»„ä»¶è¿›è¡Œæ„é€ ï¼Œæ³¨å…¥</span></span><br><span class="line">        DaggerMainActivityComponent.builder().build().inject(<span class="built_in">this</span>);</span><br><span class="line">        Log.d(TAG, <span class="string">&quot;onCreate: mTinno = &quot;</span> + mTinno);</span><br><span class="line"></span><br><span class="line">        dagger2TextView.setText(mTinno.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp; è¿™æ˜¯æœ€ç®€å•çš„ä¸€ç§ä½¿ç”¨äº†ã€‚é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°ï¼Œç¬¬ä¸€å°è±¡æ˜¯æˆ‘å»ğŸ˜²ï¼Œè¿™ä¸ªæ›´å¤æ‚äº†å•ŠğŸ˜‚ğŸ˜‚ã€‚æˆ‘åªèƒ½è¯´ç¡®å®ï¼Œå› ä¸ºè¿™ä¸ªæ˜¯å®ƒå¯¹çš„æœ€åŸºç¡€çš„ä½¿ç”¨ï¼Œçœ‹èµ·æ¥å¾ˆç¬¨æ‹™ï¼Œä½†æ˜¯å½“å®ƒåœ¨å¤§å‹é¡¹ç›®é‡Œé¢ï¼Œåœ¨ä¾èµ–æ›´å¤šçš„æƒ…å†µä¸‹ï¼Œåˆ™ä¼šå‘ç”Ÿè´¨çš„é£è·ƒï¼Œä¼šå‘ç°å®ƒéå¸¸å¥½ç”¨ï¼Œå¹¶ä¸”å°†ä½ éœ€è¦ä¼ é€’çš„å‚æ•°éƒ½éšè—æ‰ï¼Œæ¥å®ç°è§£è€¦ã€‚</p>
<h3 id="5-å¸¸è§„ä½¿ç”¨æ–¹æ³•"><a href="#5-å¸¸è§„ä½¿ç”¨æ–¹æ³•" class="headerlink" title="5. å¸¸è§„ä½¿ç”¨æ–¹æ³•"></a>5. å¸¸è§„ä½¿ç”¨æ–¹æ³•</h3><p>&emsp;&emsp;ç»†å¿ƒçš„æœ‹å‹å‘ç°äº†ï¼Œæˆ‘åœ¨ç»“æ„ä¸­è¯´ Dagger2ç»“æ„çš„æ—¶å€™æåˆ°é€šå¸¸å¿…ä¸å¯å°‘çš„ä¸‰å…ƒç´ ï¼Œè¿™ä¸ªä¾‹å­åªç”¨åˆ°äº† <strong>Component__å’Œ__Container</strong>ï¼Œè€Œ <strong>Module</strong> å¹¶æœªæåŠï¼Œé€šè¿‡ä»¥ä¸‹è¿™ä¸ªä¾‹å­ï¼Œèƒ½æ›´åŠ æ·±åˆ»çš„ç†è§£ <strong>Module</strong> çš„ä½œç”¨ã€‚<br>&emsp;&emsp;å®ç°ä¸€ä¸ª <strong>MainModule</strong>ï¼Œæä¾›ä¸€äº›å®ä¾‹æ„é€ ï¼Œé€šè¿‡ <strong>Component</strong> è”ç³»èµ·æ¥ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span> <span class="comment">//å®ç°ä¸€ä¸ªç±»ï¼Œæ ‡æ³¨ä¸º Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainModule</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span> <span class="comment">//å®ç°ä¸€äº›æä¾›æ–¹æ³•ï¼Œä¾›å¤–éƒ¨ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">public</span> Tinno <span class="title function_">provideTinno</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Tinno</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;åœ¨ <strong>MainComponent</strong> ä¸­ï¼ŒæŒ‡æ˜ <strong>Component</strong> æŸ¥æ‰¾ <strong>Module</strong> çš„ä½ç½®</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(modules = MainModule.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MainActivityComponent</span> &#123;<span class="comment">// é€šå¸¸å®šä¹‰ä¸ºæ¥å£ï¼ŒDagger2æ¡†æ¶å°†è‡ªåŠ¨ç”ŸæˆComponentçš„å®ç°ç±»ï¼Œå¯¹åº”çš„ç±»åæ˜¯DaggerÃ—Ã—Ã—Ã—Ã—ï¼Œè¿™é‡Œå¯¹åº”çš„å®ç°ç±»æ˜¯DaggerMainActivityComponent</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">inject</span><span class="params">(MainActivity activity)</span>;<span class="comment">// æ³¨å…¥åˆ°MainActivity(Container)çš„æ–¹æ³•ï¼Œæ–¹æ³•åä¸€èˆ¬ä½¿ç”¨inject</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æœ€åæˆ‘ä»¬çš„<code>Tinno</code>ç±»ä¸­çš„<code>@Inject</code>å’Œæ„é€ å‡½æ•°å¯ä»¥å»æ‰äº†(äº²æµ‹ä¸å»æ‰ä¹Ÿæ˜¯å¯ä»¥æ­£å¸¸è¿è¡Œçš„ï¼Œæ­¤æ—¶ä¹Ÿæ˜¯ä½¿ç”¨<code>Module</code>ä¸­æä¾›çš„å¯¹è±¡ï¼Œå…·ä½“å¯ä»¥é€šè¿‡åé¢åˆ†äº«çš„<code>@Scope</code>æ¥éªŒè¯ï¼Œè¿™æ ·è¯´æ˜ï¼š<strong>Componentä¼šé¦–å…ˆä»Moduleç»´åº¦ä¸­æŸ¥æ‰¾ç±»å®ä¾‹ï¼Œè‹¥æ‰¾åˆ°å°±ç”¨Moduleç»´åº¦åˆ›å»ºç±»å®ä¾‹ï¼Œå¹¶åœæ­¢æŸ¥æ‰¾Injectç»´åº¦ï¼Œå¦åˆ™æ‰æ˜¯ä»Injectç»´åº¦æŸ¥æ‰¾ç±»å®ä¾‹ï¼Œæ‰€ä»¥åˆ›å»ºç±»å®ä¾‹çº§åˆ«Moduleç»´åº¦è¦é«˜äºInjectç»´åº¦ã€‚</strong>)ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tinno</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æ³¨å…¥ä½¿ç”¨çš„åœ°æ–¹å®Œå…¨ä¸ç”¨ä¿®æ”¹ï¼Œä¹Ÿèƒ½å¾—åˆ°å’Œä¹‹å‰ä¾‹å­ä¸€æ ·çš„ç»“æœã€‚</p>
<h3 id="6-æ›´å¤šç”¨æ³•"><a href="#6-æ›´å¤šç”¨æ³•" class="headerlink" title="6. æ›´å¤šç”¨æ³•"></a>6. æ›´å¤šç”¨æ³•</h3><h4 id="6-1-æ–¹æ³•å‚æ•°"><a href="#6-1-æ–¹æ³•å‚æ•°" class="headerlink" title="6.1 æ–¹æ³•å‚æ•°"></a>6.1 æ–¹æ³•å‚æ•°</h4><p>&emsp;&emsp;ä¸Šé¢çš„ä¾‹å­<code>@Provides</code>æ ‡æ³¨çš„æ–¹æ³•æ˜¯æ²¡æœ‰è¾“å…¥å‚æ•°çš„ï¼Œ<code>Module</code>ä¸­<code>@Provides</code>æ ‡æ³¨çš„æ–¹æ³•æ˜¯å¯ä»¥å¸¦è¾“å…¥å‚æ•°çš„ï¼Œå…¶å‚æ•°å€¼å¯ä»¥ç”±<code>Module</code>ä¸­çš„å…¶ä»–è¢«<code>@Provides</code>æ ‡æ³¨çš„æ–¹æ³•æä¾›ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span> <span class="comment">//å®ç°ä¸€ä¸ªç±»ï¼Œæ ‡æ³¨ä¸º Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainModule</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Context mContext;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MainModule</span><span class="params">(Context context)</span> &#123;</span><br><span class="line">        mContext = context;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span> <span class="comment">//å®ç°ä¸€äº›æä¾›æ–¹æ³•ï¼Œä¾›å¤–éƒ¨ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">public</span> Tinno <span class="title function_">provideTinno</span><span class="params">(Gson gson, CameraTeam cameraTeam)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Tinno</span>(mContext, gson, cameraTeam);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="keyword">public</span> Gson <span class="title function_">provideGson</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">GsonBuilder</span>()</span><br><span class="line">                .excludeFieldsWithModifiers(Modifier.PROTECTED)<span class="comment">//å¿½ç•¥protectedå­—æ®µ</span></span><br><span class="line">                .setDateFormat(<span class="string">&quot;yyyy-MM-dd&#x27;T&#x27;HH:mm:ssZ&quot;</span>)</span><br><span class="line">                .create();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//    @Provides</span></span><br><span class="line"><span class="comment">//    public CameraTeam provideCameraTeam() &#123;</span></span><br><span class="line"><span class="comment">//        return new CameraTeam();</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å¦‚æœæ‰¾ä¸åˆ°è¢«<code>@Provides</code>æ³¨é‡Šçš„æ–¹æ³•æä¾›å¯¹åº”å‚æ•°å¯¹è±¡çš„è¯ï¼Œå°†ä¼šè‡ªåŠ¨è°ƒç”¨è¢«<code>@Inject</code>æ³¨é‡Šçš„æ„é€ æ–¹æ³•ç”Ÿæˆç›¸åº”å¯¹è±¡ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CameraTeam</span> &#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">CameraTeam</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ç”±äºæˆ‘ä»¬ä¿®æ”¹äº†<code>MainModule</code>ï¼Œæ‰€ä»¥å¯¹åº”æ³¨å…¥çš„åœ°æ–¹è¦ç¨å¾®ä¿®æ”¹ä¸€ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ³¨æ„æ­¤å¤„æ¯”ä¹‹å‰å¤šäº†.mainModule(new MainModule(getApplicationContext()))</span></span><br><span class="line">DaggerMainActivityComponent.builder().mainModule(<span class="keyword">new</span> <span class="title class_">MainModule</span>(getApplicationContext())).build().inject(<span class="built_in">this</span>);</span><br></pre></td></tr></table></figure>

<p><strong>æ€è€ƒ</strong><br>&emsp;&emsp; é€šè¿‡ä¸Šé¢3ä¸ªä¾‹å­<code>@Provides</code>å’Œ<code>@Inject</code>ä¸¤ç§æ–¹å¼æä¾›å¯¹è±¡çš„åŒºåˆ«ï¼Ÿ</p>
<h4 id="6-2-æ·»åŠ å¤šä¸ªModule"><a href="#6-2-æ·»åŠ å¤šä¸ªModule" class="headerlink" title="6.2 æ·»åŠ å¤šä¸ªModule"></a>6.2 æ·»åŠ å¤šä¸ªModule</h4><p>&emsp;&emsp;ä¸€ä¸ª<code>Component</code>å¯ä»¥æ·»åŠ å¤šä¸ª<code>Module</code>ï¼Œè¿™æ ·<code>Component</code>è·å–ä¾èµ–æ—¶å€™ä¼šè‡ªåŠ¨ä»å¤šä¸ª<code>Module</code>ä¸­æŸ¥æ‰¾è·å–ã€‚æ·»åŠ å¤šä¸ª<code>Module</code>æœ‰ä¸¤ç§æ–¹æ³•ï¼Œä¸€ç§æ˜¯åœ¨<code>Component</code>çš„æ³¨è§£<code>@Component(modules=&#123;Ã—Ã—Ã—Ã—ï¼ŒÃ—Ã—Ã—&#125;)</code>ä¸­æ·»åŠ å¤šä¸ª<code>modules</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component(modules=&#123;MainModule.class,ModuleA.class,ModuleB.class,ModuleC.class&#125;)</span> <span class="comment">//ç›´æ¥åœ¨Componentå¼•ç”¨å¤šä¸ª Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MainActivityComponent</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;å¦å¤–ä¸€ç§æ·»åŠ å¤šä¸ª<code>Module</code>çš„æ–¹æ³•å¯ä»¥ä½¿ç”¨<code>@Module</code>çš„ <code>includes</code>çš„æ–¹æ³•<code>ï¼ˆincludes=&#123;Ã—Ã—Ã—Ã—ï¼ŒÃ—Ã—Ã—&#125;ï¼‰</code>ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module(includes=&#123;ModuleA.class,ModuleB.class,ModuleC.class&#125;)</span><span class="comment">//å…ˆåœ¨ä¸€ä¸ª Module ä¸­includeså…¶ä»– Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainModule</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Component(modules=&#123;MainModule.class&#125;)</span> <span class="comment">//åªæœ‰ä¸€ä¸ª Module æ—¶å¯ä»¥ä¸ç”¨&#123;&#125;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MainActivityComponent</span> &#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-3-åŒºåˆ†è¿”å›ç±»å‹ç›¸åŒ-Providesæ–¹æ³•"><a href="#6-3-åŒºåˆ†è¿”å›ç±»å‹ç›¸åŒ-Providesæ–¹æ³•" class="headerlink" title="6.3 åŒºåˆ†è¿”å›ç±»å‹ç›¸åŒ@Providesæ–¹æ³•"></a>6.3 åŒºåˆ†è¿”å›ç±»å‹ç›¸åŒ@Providesæ–¹æ³•</h4><p>&emsp;&emsp;å¦‚æœæˆ‘ä»¬åœ¨ <code>Module</code> ä¸­æœ‰é‡å¤çš„ç±»å‹è¿”å›ï¼Œä¾‹å¦‚æˆ‘å®šä¹‰ä¸¤ä¸ª <code>Context</code> ç±»å‹çš„<code>Provides</code> åœ¨ <code>Module</code> ä¸­çš„è¯ï¼Œç¼–è¯‘ç›´æ¥ä¼šæŠ¥é”™ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Error:(16, 10) é”™è¯¯: android.content.Context is bound multiple times:</span><br><span class="line">@Provides android.content.Context com.ape.dagger2.MainModule.provideApplicationContext()</span><br><span class="line">@Provides android.content.Context com.ape.dagger2.MainModule.provideActivityContext()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;é‚£å¦‚æœæˆ‘ä»¬çœŸçš„éœ€è¦æ³¨å…¥åŒä¸€ç±»å‹å¤šæ¬¡å‘¢ï¼Œè¿™ä¸ªé—®é¢˜æ€»ä¼šæœ‰è§£å†³æ–¹æ¡ˆçš„å§ï¼Ÿè¦æ˜¯çœŸçš„è¿™ä¹ˆå‘ä¼°è®¡ä¹Ÿæ²¡äººç”¨ Dagger2 äº†å§ï¼å“ˆå“ˆã€‚ã€‚ã€‚ğŸ˜‚  å…¶å® Dagger2 ä¸ºæˆ‘ä»¬æä¾›äº†ä¸¤ç§æ–¹å¼æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<ul>
<li><strong>å¯ä»¥ä½¿ç”¨<code>@Qualifier</code> çš„æ³¨è§£æ¥åŒºåˆ†</strong></li>
<li><strong><code>@Named(&quot;xx&quot;)</code> çš„æ³¨è§£</strong>ã€‚</li>
</ul>
<p><strong>@Named æ–¹å¼</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Module</span> <span class="comment">//å®ç°ä¸€ä¸ªç±»ï¼Œæ ‡æ³¨ä¸º Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainModule</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Context mApplicationContext;</span><br><span class="line">    <span class="keyword">private</span> Context mActivityContext;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MainModule</span><span class="params">(Context context, Context activityContext)</span> &#123;</span><br><span class="line">        mApplicationContext = context;</span><br><span class="line">        mActivityContext = activityContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span> <span class="comment">//å®ç°ä¸€äº›æä¾›æ–¹æ³•ï¼Œä¾›å¤–éƒ¨ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">public</span> Tinno <span class="title function_">provideTinno</span><span class="params">(<span class="meta">@Named(&quot;application&quot;)</span><span class="comment">/*ä½¿ç”¨çš„æ˜¯ application*/</span>Context context, Gson gson, CameraTeam cameraTeam)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Tinno</span>(context, gson, cameraTeam);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Named(&quot;application&quot;)</span> <span class="comment">//æ ‡æ³¨ä¸º application</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="keyword">public</span> Context <span class="title function_">provideApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mApplicationContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Named(&quot;activity&quot;)</span> <span class="comment">//æ ‡æ³¨ä¸º activity</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="keyword">public</span> Context <span class="title function_">provideActivityContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mActivityContext;</span><br><span class="line">    &#125;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>@Qualifieræ–¹å¼</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Qualifier</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> ApplicationQualifier &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Qualifier</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> ActivityQualifier &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Module</span> <span class="comment">//å®ç°ä¸€ä¸ªç±»ï¼Œæ ‡æ³¨ä¸º Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainModule</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Context mApplicationContext;</span><br><span class="line">    <span class="keyword">private</span> Context mActivityContext;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">MainModule</span><span class="params">(Context context, Context activityContext)</span> &#123;</span><br><span class="line">        mApplicationContext = context;</span><br><span class="line">        mActivityContext = activityContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Provides</span> <span class="comment">//å®ç°ä¸€äº›æä¾›æ–¹æ³•ï¼Œä¾›å¤–éƒ¨ä½¿ç”¨</span></span><br><span class="line">    <span class="keyword">public</span> Tinno <span class="title function_">provideTinno</span><span class="params">(<span class="meta">@ApplicationQualifier</span><span class="comment">/*æ­¤å¤„ä½¿ç”¨ä¸º ApplicationQualifier*/</span> Context context, Gson gson, CameraTeam cameraTeam)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Tinno</span>(context, gson, cameraTeam);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApplicationQualifier</span> <span class="comment">//æ ‡æ³¨ä¸º ApplicationQualifier</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="keyword">public</span> Context <span class="title function_">provideApplicationContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mApplicationContext;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ActivityQualifier</span> <span class="comment">//æ ‡æ³¨ä¸º ActivityQualifier</span></span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="keyword">public</span> Context <span class="title function_">provideActivityContext</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mActivityContext;</span><br><span class="line">    &#125;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;ä½¿ç”¨å“ªç§æ–¹å¼å°±ä»è€…è§ä»æ™ºè€…è§æ™ºäº†ï¼Œä½†ä¸ªäººæ¨èä½¿ç”¨<code>@Qualifier</code>ï¼Œæ¯•ç«Ÿè¾“å…¥å¤ªå¤šå­—ç¬¦ä¸²å®¹æ˜“å‡ºé”™ã€‚</p>
<h4 id="6-4-ç»„ä»¶é—´ä¾èµ–å’Œå­ç»„ä»¶"><a href="#6-4-ç»„ä»¶é—´ä¾èµ–å’Œå­ç»„ä»¶" class="headerlink" title="6.4 ç»„ä»¶é—´ä¾èµ–å’Œå­ç»„ä»¶"></a>6.4 ç»„ä»¶é—´ä¾èµ–å’Œå­ç»„ä»¶</h4><p>&emsp;&emsp;æœ‰æ—¶æˆ‘ä»¬éœ€è¦ä¾èµ–ä¸€ä¸ªç»„ä»¶ï¼Œè¿™ä¸ªæœ€å¸¸è§çš„ç”¨æ³•æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å®šä¹‰äº† <code>MainActivity</code> çš„ <code>MainComponent</code> ï¼Œå¹¶ä¸”å®ƒä¾èµ–å’±ä»¬çš„ <code>AppComponent</code> é‡Œé¢çš„ <code>IRepositoryManager</code> çš„è¯å°±è¦è¿™æ ·å®šä¹‰äº†ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Component(dependencies = AppComponent.class, modules = MainPresenterModule.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MainComponent</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">inject</span><span class="params">(MainActivity activity)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;åœ¨ <code>AppComponent</code> ä¸­éœ€è¦å°†è·å– <code>IRepositoryManager</code> çš„æ–¹æ³•æš´éœ²å‡ºæ¥ï¼Œä¸ç„¶è¿˜æ˜¯æ— æ³•æ³¨å…¥æˆåŠŸçš„ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Component(modules = &#123;AppModule.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AppComponent</span> &#123;</span><br><span class="line">    <span class="comment">//ç”¨äºç®¡ç†ç½‘ç»œè¯·æ±‚å±‚,ä»¥åŠæ•°æ®ç¼“å­˜å±‚,å¯¹å¤–å¼€æ”¾çš„æ¥å£</span></span><br><span class="line">    IRepositoryManager <span class="title function_">repositoryManager</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;é‚£å¦‚æœæˆ‘è§‰å¾—æš´éœ²è¿™äº›æ–¹æ³•å¤ªéº»çƒ¦äº†ï¼Œé‚£éœ€è¦æ€ä¹ˆåŠå‘¢ï¼Ÿæœ€ç®€å•å°±æ˜¯ä½¿ç”¨ <code>@SubComponent</code> ,åœ¨æ‰€å±çš„çˆ¶ <code>Component</code> ä¸­å®šä¹‰ä¸€ä¸ª <code>SubComponent</code>ï¼Œè¯¥ <code>SubComponent</code> ä¸­å°†ä¼šåŒ…å«çˆ¶ <code>Component</code> çš„æ‰€æœ‰æ–¹æ³•ï¼Œçˆ¶ <code>Component</code> ä¸æ˜¾ç¤ºå£°æ˜éƒ½å¯ä»¥ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Subcomponent(modules = MainPresenterModule.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MainComponent</span> &#123;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">inject</span><span class="params">(MainActivity activity)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Component(modules = &#123;AppModule.class&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">AppComponent</span> &#123;</span><br><span class="line">    <span class="comment">// æä¾› MainComponent å¯¹è±¡çš„è·å–æ–¹æ³•</span></span><br><span class="line">    MainComponent <span class="title function_">mainComponent</span><span class="params">(MainPresenterModule <span class="keyword">module</span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>&emsp;&emsp;åœ¨æ³¨å…¥çš„æ—¶å€™ç›´æ¥ä½¿ç”¨çˆ¶ç»„ä»¶çš„<code>mainComponent(MainPresenterModule module)</code>åŒ…å«å­ç»„ä»¶çš„<code>module</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">appComponent.mainComponent(<span class="keyword">new</span> <span class="title class_">MainPresenterModule</span>(<span class="built_in">this</span>)).inject(<span class="built_in">this</span>);</span><br><span class="line"><span class="comment">//DaggerMainComponent.builder().appComponent(appComponent)</span></span><br><span class="line"><span class="comment">//                .mainPresenterModule(new MainPresenterModule(this)).build().inject(this);</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>ç»„ä»¶ä¾èµ–å’Œå­ç»„ä»¶çš„åŒºåˆ«</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>ç»„ä»¶ä¾èµ–</th>
<th>å­ç»„ä»¶</th>
</tr>
</thead>
<tbody><tr>
<td>1. ä¿æŒä¸¤ä¸ª Component éƒ½ç‹¬ç«‹ï¼Œæ²¡æœ‰ä»»ä½•å…³è”<br />2. æ˜ç¡®çš„å‘Šè¯‰åˆ«äººè¿™ä¸ª Component æ‰€ä¾èµ–çš„ Component <br />3. ä¸¤ä¸ªæ‹¥æœ‰ä¾èµ–å…³ç³»çš„ Component æ˜¯ä¸èƒ½æœ‰ç›¸åŒ @Scope æ³¨è§£çš„<br />4. ä¾èµ–çš„ç»„ä»¶ä¼šç”ŸæˆDaggerâ€¦Component</td>
<td>1. ä¿æŒä¸¤ä¸ª Component å†…èš<br />2. ä¸å…³å¿ƒè¿™ä¸ª Component ä¾èµ–å“ªä¸ª Component<br />3. å¯ä»¥ä½¿ç”¨ç›¸åŒçš„@Scopeæ³¨è§£<br />4. å­ç»„ä»¶çš„ç»„ä»¶ä¸ä¼šç”ŸæˆDaggerâ€¦Component</td>
</tr>
</tbody></table>
<h4 id="6-5-æ‡’åŠ è½½å’Œå¼ºåŠ è½½æ¨¡å¼"><a href="#6-5-æ‡’åŠ è½½å’Œå¼ºåŠ è½½æ¨¡å¼" class="headerlink" title="6.5 æ‡’åŠ è½½å’Œå¼ºåŠ è½½æ¨¡å¼"></a>6.5 æ‡’åŠ è½½å’Œå¼ºåŠ è½½æ¨¡å¼</h4><p>&emsp;&emsp;åœ¨ä¸Šé¢çš„æ¯”å–»ä¸­ï¼Œä¸€é’ˆæ‰è¿›å»ï¼Œæ˜¯å•¥éƒ½ç»™ä½ æ‰“è¿›å»äº†ï¼Œé‚£ä¹ˆå¦‚æœæœ‰äº›æˆ‘æƒ³è¦åœ¨è°ƒç”¨çš„æ—¶å€™æ‰åŠ è½½å‘¢ï¼Ÿè¿™é‡Œ Dagger2 æä¾›äº† <code>Lazy&lt;T&gt;</code> çš„æ–¹å¼æ¥æ³¨å…¥ï¼›åŒæ—¶ç›¸åçš„æä¾›ä¸€ä¸ªå¼ºåˆ¶åŠ è½½æ–¹å¼<code>Provider&lt;T&gt;</code>ï¼Œæ¯æ¬¡è°ƒç”¨getéƒ½ä¼šè°ƒç”¨Moduleçš„Providesæ–¹æ³•ä¸€æ¬¡ï¼Œå¯¹åº”çš„è·å–å°±æ˜¯ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Container</span>&#123;</span><br><span class="line">    <span class="meta">@Inject</span> Lazy&lt;Tinno&gt; mTinnoLazy; <span class="comment">//å»¶è¿ŸåŠ è½½</span></span><br><span class="line">    <span class="meta">@Inject</span> Provider&lt;Tinno&gt; mTinnoProvider;<span class="comment">//å®ç°å¼ºåˆ¶åŠ è½½ï¼Œæ¯æ¬¡è°ƒç”¨getéƒ½ä¼šè°ƒç”¨Moduleçš„Providesæ–¹æ³•ä¸€æ¬¡ï¼Œå’Œæ‡’åŠ è½½æ¨¡å¼æ­£å¥½ç›¸å,æ¯”å¦‚æˆ‘ä»¬éœ€è¦ä¸€æ¬¡æ€§åˆ›å»ºå‡º10ä¸ªTinno å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span>&#123;</span><br><span class="line">        DaggerComponent.create().inject(<span class="built_in">this</span>);</span><br><span class="line">        <span class="type">Tinno</span> <span class="variable">tinno</span> <span class="operator">=</span> mTinnoLazy.get();  <span class="comment">//è°ƒç”¨getæ—¶æ‰åˆ›å»ºb</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6-6-Scopeè¯¦è§£"><a href="#6-6-Scopeè¯¦è§£" class="headerlink" title="6.6 @Scopeè¯¦è§£"></a>6.6 <code>@Scope</code>è¯¦è§£</h4><p><strong>@Scope æ˜¯ä»€ä¹ˆ</strong><br>&emsp;&emsp; <code>Scope</code> ç¿»è¯‘è¿‡æ¥å°±æ˜¯è¾–åŸŸï¼Œå†ç»“åˆåˆ°è®¡ç®—æœºä¸Šï¼Œå…¶å®å°±æ˜¯ä½œç”¨åŸŸçš„æ„æ€ï¼Œå­¦è¿‡é«˜çº§è¯­è¨€çš„åº”è¯¥éƒ½çŸ¥é“è®¾è®¡æ¨¡å¼ä¸­ä¸€ä¸ªæ¨¡å¼å«åšå•ä¾‹æ¨¡å¼ï¼Œå•ä¾‹å³ä¸ºå…¨å±€ä¸­è¯¥å¯¹è±¡çš„å®ä¾‹åªå­˜åœ¨ä¸€ä¸ªï¼Œè€Œåœ¨ Dagger2 ä¸­ï¼Œ<code>@scope</code> çš„ä¸€ä¸ªé»˜è®¤å®ç°å°±æ˜¯ <code>@Singleton</code>ï¼Œä¹Ÿæ˜¯Dagger2å”¯ä¸€è‡ªå¸¦çš„Scopeæ³¨è§£ï¼Œä¸‹é¢æ˜¯<code>@Singleton</code>çš„æºç ï¼Œä¹ä¸€çœ‹ï¼Œå¾ˆç¥å¥‡å•Šï¼Œä»…ä»…ä½¿ç”¨ä¸€ä¸ªæ³¨è§£å°±å¯ä»¥å®ç°å•ä¾‹ï¼</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Scope</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Singleton&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ°å®šä¹‰ä¸€ä¸ª<code>Scope</code>æ³¨è§£ï¼Œé€šå¸¸éœ€è¦æ·»åŠ ä»¥ä¸‹ä¸‰éƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>@Scope</strong>ï¼šæ³¨æ˜æ˜¯Scope</li>
<li><strong>@Documented</strong>ï¼šæ ‡è®°æ–‡æ¡£æç¤ºï¼Œå¯ä»¥ä¸ç”¨</li>
<li><strong>@Retention(RUNTIME)</strong>ï¼šè¿è¡Œæ—¶çº§åˆ«</li>
</ul>
<p><strong>@Scpoe æ€ä¹ˆç”¨</strong><br>&emsp;&emsp; é‚£ä¹ˆæ¥ä¸‹æ¥æˆ‘ä»¬å°±çœ‹ä¸€ä¸‹å®ƒçš„ä½¿ç”¨ã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ™®é€šçš„å¯¹è±¡</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Tinno</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Module</span><span class="comment">//å£°æ˜Module</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainModule</span> &#123;</span><br><span class="line">    <span class="meta">@Provides</span></span><br><span class="line">    <span class="meta">@Singleton</span></span><br><span class="line">    Tinno <span class="title function_">provideTinno</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Tinno</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Singleton</span></span><br><span class="line"><span class="meta">@Component(modules = UserModule.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MainActivityComponent</span> &#123;<span class="comment">//åŒä¸€ä¸ªComponentå¯ä»¥å£°æ˜å¤šä¸ªæ³¨å…¥Container</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">inject</span><span class="params">(MainActivity activity)</span>;</span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">inject</span><span class="params">(SecondActivity activity)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp; æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ™®é€šçš„ <code>Tinno</code> ç±»ï¼Œç„¶ååˆ›å»ºå®ƒçš„<code>Module</code>ï¼Œå¹¶ä¸”ç”¨ <code>@Singleton</code> æ ‡è®°è¯¥ <code>Tinno</code> è¿”å›å¯¹è±¡ï¼Œæœ€åæˆ‘ä»¬å†åˆ›å»ºå®ƒçš„ <code>Component</code>ï¼Œç„¶åç”¨ <code>@Singleton</code> æ ‡è®°è¿™ä¸ª <code>Component</code>ã€‚è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„å¥—è·¯æµç¨‹ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬åˆ›å»ºä¸€ä¸ª <code>MainActivity</code> å’Œä¸€ä¸ª <code>SecondActivity</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MainActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Tinno mTinno1;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Tinno mTinno2;</span><br><span class="line">    <span class="keyword">private</span> TextView mContentTextView;</span><br><span class="line">    <span class="keyword">private</span> Button mContentButton;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        mContentTextView = (TextView) findViewById(R.id.tv_content);</span><br><span class="line">        mContentButton = (Button) findViewById(R.id.btn_content);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// [1]</span></span><br><span class="line">        <span class="type">MainActivityComponent</span> <span class="variable">component</span> <span class="operator">=</span> DaggerMainActivityComponent.create();</span><br><span class="line">        component.inject(<span class="built_in">this</span>);</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€è¡Œä¸º mTinno1 çš„ä¿¡æ¯ï¼Œç¬¬äºŒè¡Œä¸º mTinno2 çš„ä¿¡æ¯ï¼Œç¬¬ä¸‰è¡Œä¸ºè¯¥ç±»ä¸­ MainActivityComponent çš„ä¿¡æ¯</span></span><br><span class="line">        mContentTextView.setText(mTinno1.toString() + <span class="string">&quot;\n&quot;</span> + mTinno2.toString()+<span class="string">&quot;\n&quot;</span>+ component.toString());</span><br><span class="line">        mContentButton.setOnClickListener(<span class="keyword">new</span> <span class="title class_">View</span>.OnClickListener() &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onClick</span><span class="params">(View v)</span> &#123;</span><br><span class="line">                startActivity(<span class="keyword">new</span> <span class="title class_">Intent</span>(MainActivity.<span class="built_in">this</span>, SecondActivity.class));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SecondActivity</span> <span class="keyword">extends</span> <span class="title class_">AppCompatActivity</span> &#123;</span><br><span class="line">    <span class="meta">@Inject</span></span><br><span class="line">    Tinno mTinno;</span><br><span class="line">    <span class="keyword">private</span> TextView mContentTextView;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">(Bundle savedInstanceState)</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_second);</span><br><span class="line">        mContentTextView = (TextView) findViewById(R.id.tv_content);</span><br><span class="line">        <span class="comment">// [2]</span></span><br><span class="line">        <span class="type">MainActivityComponent</span> <span class="variable">component</span> <span class="operator">=</span> DaggerMainActivityComponent.create();</span><br><span class="line">        component.inject(<span class="built_in">this</span>);</span><br><span class="line">        <span class="comment">// ç¬¬ä¸€è¡Œä¸º mTinno çš„ä¿¡æ¯ï¼Œç¬¬äºŒè¡Œä¸ºè¯¥ç±»ä¸­ MainActivityComponent çš„ä¿¡æ¯</span></span><br><span class="line">        mContentTextView.setText(mTinno.toString() + <span class="string">&quot;\n&quot;</span> + component.toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œç»“æœå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œæ²¡æœ‰é—®é¢˜çš„ï¼Œå•ä¾‹å®ç°æˆåŠŸäº†ï¼Œå‘ç°ä¸¤ä¸ª <code>Tinno</code>çš„åœ°å€æ˜¯ä¸€æ ·çš„ã€‚</p>
<div align="center"><img src="https://raw.githubusercontent.com/way1989/way1989.github.io/hexo/images_post/dagger2/2.png"/></div>

<p>æˆ‘ä»¬ä»…ä»…é€šè¿‡ä¸€ä¸ª <code>@Singleton</code> æ ‡è®°å°±ä½¿å¾—å¯¹è±¡å®ç°äº†å•ä¾‹æ¨¡å¼ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç‚¹ä¸€ä¸‹æŒ‰é’®è·³è½¬åˆ° <code>SecondActivity</code> ä¸­ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p>
<div align="center"><img src="https://raw.githubusercontent.com/way1989/way1989.github.io/hexo/images_post/dagger2/3.png"/></div>

<p>&emsp;&emsp;ä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬å‘ç°ï¼Œä¸å¯¹å•Šï¼Œ<code>SecondActivity</code> çš„ <code>Tinno</code> å¯¹è±¡çš„åœ°å€å’Œ <code>MainActivity</code> ä¸­çš„ <code>Tinno</code> å¯¹è±¡åœ°å€å¹¶ä¸ä¸€æ ·å•Šï¼Œè¿™ä¸ªå•ä¾‹å¥½åƒå¤±æ•ˆäº†å•Šï¼äº‹å®ä¸Šå¹¶ä¸æ˜¯è¿™æ ·ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆè¿™ä¸ªå•ä¾‹â€œå¤±æ•ˆâ€äº†å‘¢ï¼Ÿç»†å¿ƒçš„å°ä¼™ä¼´ä»¬å·²ç»çœ‹åˆ°äº†ï¼Œä¸¤ä¸ª <code>Activity</code> ä¸­çš„ <code>Component</code> å¯¹è±¡çš„åœ°å€æ˜¯å¹¶ä¸ä¸€æ ·çš„ï¼Œè¿™æ ·å°±å¥½ç†è§£äº† â€”â€”â€” ç”±äº <code>Component</code> å¯¹è±¡ä¸æ˜¯åŒä¸€ä¸ªï¼Œå½“ç„¶å®ƒä»¬æ³¨å…¥çš„å¯¹è±¡ä¹Ÿä¸ä¼šæ˜¯åŒä¸€ä¸ªã€‚é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ<br>æˆ‘ä»¬åœ¨ <code>Application</code> å±‚åˆå§‹åŒ– <code>MainActivityComponent</code>ï¼Œç„¶ååœ¨ <code>Activity</code> ä¸­ç›´æ¥è·å–è¿™ä¸ª <code>MainActivityComponent</code> å¯¹è±¡ï¼Œç”±äº <code>Application</code> åœ¨å…¨å±€ä¸­åªä¼šåˆå§‹åŒ–ä¸€æ¬¡ï¼Œ æ‰€ä»¥ <code>Application</code> ä¸­çš„ <code>MainActivityComponent</code> å¯¹è±¡åªåˆå§‹åŒ–ä¸€æ¬¡ï¼Œæˆ‘ä»¬æ¯æ¬¡åœ¨ <code>Activity</code> ä¸­è·å– <code>Application</code> ä¸­çš„è¿™ä¸ª <code>MainActivityComponent</code> å½“ç„¶å°±æ˜¯åŒä¸€ä¸ªçš„å•¦ã€‚<code>Application</code> ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">App</span> <span class="keyword">extends</span> <span class="title class_">Application</span> &#123;</span><br><span class="line">    MainActivityComponent mComponent;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">onCreate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="built_in">super</span>.onCreate();</span><br><span class="line">        mComponent = DaggerMainActivityComponent.create();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> MainActivityComponent <span class="title function_">getComponent</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mComponent;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æˆ‘ä»¬åªéœ€è¦å°† [1] å’Œ [2] å¤„çš„ä»£ç æ›´æ”¹æˆ <code>MainActivityComponent component = ((App)getApplication()).getComponent();</code>è¿™æ ·æˆ‘ä»¬ä¸å°±èƒ½å°†æˆ‘ä»¬çš„ <code>MainActivityComponent</code> â€œå•ä¾‹â€åŒ–äº†å—ï¼Ÿæˆªå›¾è¿™é‡Œå°±ä¸å†è´´å‡ºäº†ã€‚</p>
<p><strong>è‡ªå®šä¹‰@Scpoe</strong></p>
<p>&emsp;&emsp;Dagger2ä¸­<code>@Singleton</code>å’Œè‡ªå·±å®šä¹‰çš„<code>@ActivityScope</code>ã€<code>@ApplicationScope</code>ç­‰ä»£ç ä¸Šå¹¶æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼ŒåŒºåˆ«æ˜¯åœ¨é‚£ç§<code>Component</code>ä¾èµ–çš„<code>Component</code>çš„æƒ…å†µä¸‹ï¼Œä¸¤ä¸ª<code>Component</code>çš„<code>@Scope</code>ä¸èƒ½ç›¸åŒï¼Œæ—¢ç„¶æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜è¦è¿™ä¹ˆåšå‘¢ï¼Ÿæ˜¯å› ä¸ºè¿™æ ·æ ‡ç¤ºå¯ä»¥æ¸…æ™°çš„åŒºåˆ†<code>Component</code>ä¾èµ–çš„å±‚æ¬¡ï¼Œæ–¹ä¾¿ç†æ¸…æˆ‘ä»¬çš„ä»£ç é€»è¾‘å±‚æ¬¡ï¼Œå¦‚ä¸‹ä¸ºè‡ªå®šä¹‰çš„<code>ActivityScope</code>ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Scope</span></span><br><span class="line"><span class="meta">@Documented</span></span><br><span class="line"><span class="meta">@Retention(RUNTIME)</span></span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> ActivityScope &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æœ‰<code>@Scope</code>æ³¨è§£å’Œæ²¡<code>@Scope</code>æ³¨è§£çš„ç¼–è¯‘æ—¶ç”Ÿæˆä»£ç çš„åŒºåˆ«ï¼Œåœ¨ç¼–è¯‘ç”Ÿæˆçš„<code>DaggerMainActivityComponent</code>çš„<code>initialize</code>å‡½æ•°ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å¦‚ä¸‹ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initialize</span><span class="params">(<span class="keyword">final</span> Builder builder)</span> &#123;</span><br><span class="line">    <span class="comment">//æ ‡è®°äº†`@Singleton`ä¸­`DaggerMainActivityComponent`ä¸­å®ä¾‹åŒ–provideTinnoProvideræ–¹å¼</span></span><br><span class="line">    <span class="built_in">this</span>.provideTinnoProvider =</span><br><span class="line">      DoubleCheck.provider(MainModule_ProvideTinnoFactory.create(builder.mainModule));</span><br><span class="line">    <span class="comment">//æœªæ ‡è®°</span></span><br><span class="line">    <span class="built_in">this</span>.provideTinnoProvider = MainModule_ProvideTinnoFactory.create(builder.mainModule);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;æœ‰<code>@Scope</code>ç±»æ³¨è§£çš„<code>@Provider</code>ç”Ÿæˆçš„ä»£ç ï¼Œå¤–å±‚å¤šäº†ä¸€å±‚<code>DoubleCheck.provider(â€¦);</code>æ²¡æœ‰<code>@Scope</code>ç±»æ³¨è§£çš„åˆ™æ˜¯ç›´æ¥createä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚å…³äº<code>DoubleCheck</code>ï¼Œç®€å•æ¥è¯´å°±æ˜¯åŠ äº†<code>@Scope</code>çš„<code>Provider</code>ï¼Œ<code>Dagger</code>ä¼šç¼“å­˜ä¸€ä¸ªå®ä¾‹åœ¨<code>DaggerMainComponent</code>ä¸­ï¼Œåœ¨<code>DaggerMainComponent</code>ä¸­ä¿æŒå•ä¾‹ï¼Œç¼“å­˜çš„<code>provide</code>è·Ÿéš<code>DaggerMainComponent</code>çš„ç”Ÿå‘½å‘¨æœŸï¼Œ<code>DaggerMainComponent</code>è¢«é”€æ¯æ—¶ï¼Œ<code>provider</code>ä¹Ÿè¢«é”€æ¯ï¼Œè¿™å°±æ˜¯å±€éƒ¨å•ä¾‹çš„æ¦‚å¿µï¼Œå‡å¦‚ä½ çš„<code>DaggerMainComponent</code>æ˜¯åœ¨ä½ åº”ç”¨çš„<code>application</code>ä¸­ï¼Œåˆ™å°±å½¢æˆäº†å…¨å±€å•ä¾‹ã€‚</p>
<h2 id="ä¸‰-å°ç»“"><a href="#ä¸‰-å°ç»“" class="headerlink" title="ä¸‰. å°ç»“"></a>ä¸‰. å°ç»“</h2><h3 id="1-Dagger2åˆ°åº•æœ‰å“ªäº›å¥½å¤„ï¼Ÿ"><a href="#1-Dagger2åˆ°åº•æœ‰å“ªäº›å¥½å¤„ï¼Ÿ" class="headerlink" title="1. Dagger2åˆ°åº•æœ‰å“ªäº›å¥½å¤„ï¼Ÿ"></a>1. Dagger2åˆ°åº•æœ‰å“ªäº›å¥½å¤„ï¼Ÿ</h3><ul>
<li><p><strong>å¢åŠ å¼€å‘æ•ˆç‡ã€çœå»é‡å¤çš„ç®€å•ä½“åŠ›åŠ³åŠ¨</strong><br>é¦–å…ˆnewä¸€ä¸ªå®ä¾‹çš„è¿‡ç¨‹æ˜¯ä¸€ä¸ªé‡å¤çš„ç®€å•ä½“åŠ›åŠ³åŠ¨ï¼ŒDagger2å®Œå…¨å¯ä»¥æŠŠnewä¸€ä¸ªå®ä¾‹çš„å·¥ä½œåšäº†ï¼Œå› æ­¤æˆ‘ä»¬æŠŠä¸»è¦ç²¾åŠ›é›†ä¸­åœ¨å…³é”®ä¸šåŠ¡ä¸Šã€åŒæ—¶ä¹Ÿèƒ½å¢åŠ å¼€å‘æ•ˆç‡ä¸Šã€‚çœå»å†™å•ä¾‹çš„æ–¹æ³•ï¼Œå¹¶ä¸”ä¹Ÿä¸éœ€è¦æ‹…å¿ƒè‡ªå·±å†™çš„å•ä¾‹æ–¹æ³•æ˜¯å¦çº¿ç¨‹å®‰å…¨ï¼Œè‡ªå·±å†™çš„å•ä¾‹æ˜¯æ‡’æ±‰æ¨¡å¼è¿˜æ˜¯é¥¿æ±‰æ¨¡å¼ã€‚å› ä¸ºDagger2éƒ½å¯ä»¥æŠŠè¿™äº›å·¥ä½œåšäº†ã€‚</p>
</li>
<li><p><strong>æ›´å¥½çš„ç®¡ç†ç±»å®ä¾‹</strong><br>æ¯ä¸ªappä¸­çš„ApplicationComponentç®¡ç†æ•´ä¸ªappçš„å…¨å±€ç±»å®ä¾‹ï¼Œæ‰€æœ‰çš„å…¨å±€ç±»å®ä¾‹éƒ½ç»Ÿä¸€äº¤ç»™ApplicationComponentç®¡ç†ï¼Œå¹¶ä¸”å®ƒä»¬çš„ç”Ÿå‘½å‘¨æœŸä¸appçš„ç”Ÿå‘½å‘¨æœŸä¸€æ ·ã€‚æ¯ä¸ªé¡µé¢å¯¹åº”è‡ªå·±çš„Componentï¼Œé¡µé¢Componentç®¡ç†ç€è‡ªå·±é¡µé¢æ‰€ä¾èµ–çš„æ‰€æœ‰ç±»å®ä¾‹ã€‚å› ä¸ºComponentï¼ŒModuleï¼Œæ•´ä¸ªappçš„ç±»å®ä¾‹ç»“æ„å˜çš„å¾ˆæ¸…æ™°ã€‚</p>
</li>
<li><p><strong>è§£è€¦</strong><br>å‡å¦‚ä¸ç”¨Dagger2çš„è¯ï¼Œä¸€ä¸ªç±»çš„newä»£ç æ˜¯éå¸¸å¯èƒ½å……æ–¥åœ¨appçš„å¤šä¸ªç±»ä¸­çš„ï¼Œå‡å¦‚è¯¥ç±»çš„æ„é€ å‡½æ•°å‘ç”Ÿå˜åŒ–ï¼Œé‚£è¿™äº›æ¶‰åŠåˆ°çš„ç±»éƒ½å¾—è¿›è¡Œä¿®æ”¹ã€‚è®¾è®¡æ¨¡å¼ä¸­æå€¡æŠŠå®¹æ˜“å˜åŒ–çš„éƒ¨åˆ†å°è£…èµ·æ¥ã€‚</p>
</li>
</ul>
<h3 id="2-Dagger2åœ¨Cameraä¸­ä½¿ç”¨æ€è€ƒï¼"><a href="#2-Dagger2åœ¨Cameraä¸­ä½¿ç”¨æ€è€ƒï¼" class="headerlink" title="2. Dagger2åœ¨Cameraä¸­ä½¿ç”¨æ€è€ƒï¼"></a>2. Dagger2åœ¨Cameraä¸­ä½¿ç”¨æ€è€ƒï¼</h3><ul>
<li><strong>CameraScheduler</strong> ä¸­ä¾èµ–çš„å„ä¸ªæ¨¡å—å®ä¾‹å¯ä»¥é€šè¿‡Dagger2æ³¨å…¥ï¼Œå›è°ƒæ¥å£ä¹Ÿå¯ä»¥åœ¨æ³¨å…¥çš„æ—¶å€™ä¼ é€’è¿‡å»ï¼Œç±»ä¼¼ä¸MVPæ¨¡å¼å°†Vä¼ é€’ç»™Pã€‚</li>
<li>å„ä¸ªå­æ¨¡å—ä¹Ÿå¯ä»¥ä½¿ç”¨Dagger2æ¥æ³¨å…¥ç›¸å…³å®ä¾‹ã€‚</li>
</ul>
<p><strong>æœ¬æ–‡æ‰€æ¼”ç¤ºçš„ä»£ç åœ¨æ­¤ä¸‹è½½</strong>ï¼š<a href="https://github.com/way1989/Dagger2Test">Dagger2Sample</a></p>
<p><strong>MVPä½¿ç”¨ Dagger2çš„ä¾‹å­åœ¨æ­¤ä¸‹è½½</strong>ï¼š<a href="https://github.com/way1989/MaterialWeather">MaterialWeather</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Dagger2/" rel="tag"># Dagger2</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2017/06/07/notes/AndroidLanguage/" rel="prev" title="Androidå¼€å‘å„å›½è¯­è¨€åç¼€å¯¹ç…§">
      <i class="fa fa-chevron-left"></i> Androidå¼€å‘å„å›½è¯­è¨€åç¼€å¯¹ç…§
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80-Dagger2%E4%BB%8B%E7%BB%8D"><span class="nav-number">1.</span> <span class="nav-text">ä¸€. Dagger2ä»‹ç»</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Dagger2%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-number">1.1.</span> <span class="nav-text">1.Dagger2æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Dagger2%E7%9B%B8%E8%BE%83%E4%BA%8EDagger1%E7%9A%84%E4%BC%98%E5%8A%BF%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-number">1.2.</span> <span class="nav-text">2. Dagger2ç›¸è¾ƒäºDagger1çš„ä¼˜åŠ¿æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E4%BD%BF%E7%94%A8%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%E7%9A%84%E6%9C%80%E5%A4%A7%E5%A5%BD%E5%A4%84%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="nav-number">1.3.</span> <span class="nav-text">3. ä½¿ç”¨ä¾èµ–æ³¨å…¥çš„æœ€å¤§å¥½å¤„æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E4%B8%BE%E4%B8%AA%E4%BE%8B%E5%AD%90"><span class="nav-number">1.4.</span> <span class="nav-text">4. ä¸¾ä¸ªä¾‹å­</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C-Dagger2%E4%BD%BF%E7%94%A8"><span class="nav-number">2.</span> <span class="nav-text">äºŒ. Dagger2ä½¿ç”¨</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-gradle%E9%85%8D%E7%BD%AE"><span class="nav-number">2.1.</span> <span class="nav-text">1. gradleé…ç½®</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-%E6%B3%A8%E8%A7%A3"><span class="nav-number">2.2.</span> <span class="nav-text">2. æ³¨è§£</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%BB%93%E6%9E%84"><span class="nav-number">2.3.</span> <span class="nav-text">3. ç»“æ„</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-%E7%AE%80%E5%8D%95%E7%9A%84%E4%BE%8B%E5%AD%90"><span class="nav-number">2.4.</span> <span class="nav-text">4. ç®€å•çš„ä¾‹å­</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-%E5%B8%B8%E8%A7%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95"><span class="nav-number">2.5.</span> <span class="nav-text">5. å¸¸è§„ä½¿ç”¨æ–¹æ³•</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-%E6%9B%B4%E5%A4%9A%E7%94%A8%E6%B3%95"><span class="nav-number">2.6.</span> <span class="nav-text">6. æ›´å¤šç”¨æ³•</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#6-1-%E6%96%B9%E6%B3%95%E5%8F%82%E6%95%B0"><span class="nav-number">2.6.1.</span> <span class="nav-text">6.1 æ–¹æ³•å‚æ•°</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-2-%E6%B7%BB%E5%8A%A0%E5%A4%9A%E4%B8%AAModule"><span class="nav-number">2.6.2.</span> <span class="nav-text">6.2 æ·»åŠ å¤šä¸ªModule</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-3-%E5%8C%BA%E5%88%86%E8%BF%94%E5%9B%9E%E7%B1%BB%E5%9E%8B%E7%9B%B8%E5%90%8C-Provides%E6%96%B9%E6%B3%95"><span class="nav-number">2.6.3.</span> <span class="nav-text">6.3 åŒºåˆ†è¿”å›ç±»å‹ç›¸åŒ@Providesæ–¹æ³•</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-4-%E7%BB%84%E4%BB%B6%E9%97%B4%E4%BE%9D%E8%B5%96%E5%92%8C%E5%AD%90%E7%BB%84%E4%BB%B6"><span class="nav-number">2.6.4.</span> <span class="nav-text">6.4 ç»„ä»¶é—´ä¾èµ–å’Œå­ç»„ä»¶</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-5-%E6%87%92%E5%8A%A0%E8%BD%BD%E5%92%8C%E5%BC%BA%E5%8A%A0%E8%BD%BD%E6%A8%A1%E5%BC%8F"><span class="nav-number">2.6.5.</span> <span class="nav-text">6.5 æ‡’åŠ è½½å’Œå¼ºåŠ è½½æ¨¡å¼</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#6-6-Scope%E8%AF%A6%E8%A7%A3"><span class="nav-number">2.6.6.</span> <span class="nav-text">6.6 @Scopeè¯¦è§£</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89-%E5%B0%8F%E7%BB%93"><span class="nav-number">3.</span> <span class="nav-text">ä¸‰. å°ç»“</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-Dagger2%E5%88%B0%E5%BA%95%E6%9C%89%E5%93%AA%E4%BA%9B%E5%A5%BD%E5%A4%84%EF%BC%9F"><span class="nav-number">3.1.</span> <span class="nav-text">1. Dagger2åˆ°åº•æœ‰å“ªäº›å¥½å¤„ï¼Ÿ</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-Dagger2%E5%9C%A8Camera%E4%B8%AD%E4%BD%BF%E7%94%A8%E6%80%9D%E8%80%83%EF%BC%81"><span class="nav-number">3.2.</span> <span class="nav-text">2. Dagger2åœ¨Cameraä¸­ä½¿ç”¨æ€è€ƒï¼</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">liweiping</p>
  <div class="site-description" itemprop="description">çˆ±ç”Ÿæ´»...çˆ±Android...</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">17</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">liweiping</span>
</div>
  <div class="powered-by">ç”± <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> å¼ºåŠ›é©±åŠ¨
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
